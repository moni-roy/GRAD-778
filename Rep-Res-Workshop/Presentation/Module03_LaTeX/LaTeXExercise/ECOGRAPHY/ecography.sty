%%% ========================================================= %%%
%%% Package ecography.sty                                     %%%
%%% Mathieu Basille basille@ase-research.org                  %%%
%%% 03.06.2008                                                %%%
%%% ========================================================= %%%


%%% Encodage et police
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
%%% Package divers et langue
\usepackage{graphicx, url, color}
\usepackage[english]{babel}
%%% Mise en page : A4 large, numérotation de toutes les lignes, interligne double, aligné
%%% à gauche sans justification, paragraphes indentés
\usepackage{a4wide}
\usepackage{lineno}
  \pagewiselinenumbers
\usepackage{setspace}
  \doublespacing
\usepackage[document]{ragged2e}
  \setlength\RaggedRightParindent{\parindent}
  \setlength\RaggedRightRightskip{0pt plus 1fil}
%%% Style de bibliographie adapté à Ecography, gestion des \cite dans le texte
\usepackage{natbib}
  \bibliographystyle{ecography}
  \bibpunct{(}{)}{,}{a}{}{,}


%%% Trois nouvelles commandes pour le '\maketitle' : 
%%% '\running' : Running head
%%% '\words' : Number of words
%%% '\affiliations' : Affiliations, à placer dans des \item
\newcommand{\@affiliations}{}
\newcommand{\affiliations}[1]{\renewcommand{\@affiliations}{#1}}
\newcommand{\@running}{}
\newcommand{\running}[1]{\renewcommand{\@running}{#1}}
\newcommand{\@nwords}{}
\newcommand{\nwords}[1]{\renewcommand{\@nwords}{#1}}


%%% Commande '\maketitle' modifiée pour prendre en compte \running, \words, \affiliations
\renewcommand\maketitle{\begin{titlepage}%
    \let\footnotesize\small
    \let\footnoterule\relax
    \let \footnote \thanks
    \singlespacing%
    \textbf{Running title:} \@running \par%
    \textbf{Number of words:} $\sim$\@nwords \par%
    \vskip 1em%
    \textbf{Date of submission:} \@date \par%
    \vskip 4em%
    \begin{center}%
      {\Large \sffamily \bfseries \@title \par}%
      \vskip 3em%
      {\large \sffamily
        \lineskip .75em%
        \begin{tabular}[t]{c}%
          \@author
        \end{tabular}\par}%
    \end{center}\par
    \vskip 4em%
    \begin{enumerate}%
      \itshape%
      \@affiliations%
    \end{enumerate}%
    \@thanks
    \vfil\null
  \end{titlepage}%
  \setcounter{footnote}{0}%
  \global\let\thanks\relax
  \global\let\maketitle\relax
  \global\let\@thanks\@empty
  \global\let\@author\@empty
  \global\let\@date\@empty
  \global\let\@title\@empty
  \global\let\title\relax
  \global\let\author\relax
  \global\let\date\relax
  \global\let\and\relax
}


%%% Environnement 'thebibliography' en \small
\let\orig@thebibliography\thebibliography
\let\endorig@thebibliography\endthebibliography
\renewenvironment*{thebibliography}
{\small%
  \orig@thebibliography}%
{\endorig@thebibliography}


%%% Environnement 'tabular' sans indentation de paragraphe
\let\orig@tabular\tabular
\let\endorig@tabular\endtabular
\renewenvironment*{tabular}
{\setlength\RaggedRightParindent{0pt}%
  \orig@tabular}%
{\endorig@tabular}


%%% Environnement 'abstract' dans le style du journal
\renewenvironment{abstract}{%
  \small
  \begin{center}%
    {\sf\bfseries \abstractname\vspace{-.5em}\vspace{\z@}}%
  \end{center}%
  \quotation}
{\endquotation}


%%% Style des titres
\renewcommand\section{\@startsection {section}{1}{\z@}%
  {-3.5ex \@plus -1ex \@minus -.2ex}%
  {2.3ex \@plus.2ex}%
  {\Large\sf\bfseries}}
\renewcommand\subsection{\@startsection{subsection}{2}{\z@}%
  {-3.25ex\@plus -1ex \@minus -.2ex}%
  {1.5ex \@plus .2ex}%
  {\large\sf\bfseries}}
\renewcommand\subsubsection{\@startsection{subsubsection}{3}{\z@}%
  {-3.25ex\@plus -1ex \@minus -.2ex}%
  {1.5ex \@plus .2ex}%
  {\normalfont\normalsize\sf\bfseries}}
